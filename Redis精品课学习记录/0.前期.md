# 0.基本介绍
## 1.官网介绍
> Redis是一个开源（BSD许可），**内存存储**的数据结构服务器，可用作**数据库，高速缓存和消息队列代理**。它支持[字符串](https://www.redis.net.cn/tutorial/3508.html)、[哈希表](https://www.redis.net.cn/tutorial/3509.html)、[列表](https://www.redis.net.cn/tutorial/3510.html)、[集合](https://www.redis.net.cn/tutorial/3511.html)、[有序集合](https://www.redis.net.cn/tutorial/3512.html)，[位图](https://www.redis.net.cn/tutorial/3508.html)，[hyperloglogs](https://www.redis.net.cn/tutorial/3513.html)等数据类型。内置复制、[Lua脚本](https://www.redis.net.cn/tutorial/3516.html)、LRU收回、[事务](https://www.redis.net.cn/tutorial/3515.html)以及不同级别磁盘持久化功能，同时通过Redis Sentinel提供高可用，通过Redis Cluster提供自动[分区](https://www.redis.net.cn/tutorial/3524.html)。


* 内存存储:将数据直接存储到内存之中,读取速度更快
* 用途有三个:数据库,缓存,消息队列
* databases:存储数据,相较于MySQL是将数据存储到内存上
* high speed cache: 虽然在内存上存储数据,但是内存最大的缺点是空间太少,存储的数据量有限,可以将Redis和MySQL结合,Redis存储热点数据,MySQL存储全量的数据,既充当了应用服务器和存储服务器之间的缓存,又可以加快热点数据的读取,所以称之为**高速缓存**
* 消息队列:这是Redis设计的初心,但是在实际应用中并不是很广泛


## 2.什么时候要用Redis
> 适合在**分布式**系统中存储数据

分布式系统是相较于单机架构的一个概念,传统的单机架构是只有一个服务器.这个服务器上可以部署应用服务器和存储服务器,一个服务器对应一套主机的硬件资源,这里的硬件资源指的是主机对应的cpu,内存,硬盘,网络等资源(这也是性能测试中需要关注的指标),每次请求都需要消耗上述服务器资源

传统的单机架构在应对海量数据时,单台服务器的资源可能无法及时处理,极易达到服务器瓶颈(比如访问时间过慢,服务器过载出现异常等等),如何解决呢?
* 开源:引入更多的主机,意味着引入更多的硬件资源
* 节流:优化算法复杂度,占用带宽等等,从软件上进行优化

而所谓的分布式,就是开源思想提供的一套解决方案

# 三.分布式系统演进

**数据库分离**
![[Pasted image 20250920225447.png]]
传统的单机架构服务器中,应用服务器和存储服务器都在一台主机上,消耗的是同一份硬件资源
现在,将应用服务器和存储服务器分别部署在不同的服务器上;这样做的好处:
1. 降低服务器的压力,一个硬件资源被一个服务器持有
2. 定制化硬件资源:应用服务器更多的是处理业务相关逻辑,消耗的资源更多是cpu,而存储服务器更多是数据的存储和查询,消耗的资源更多是磁盘和硬盘;可以根据不同服务器的特点,引入不同的硬件资源,从而更大化利用硬件资源

如果需要处理的数据量更多呢?**引入更多的应用服务器**
![[Pasted image 20250920225739.png]]
这里的核心在于引入了**负载均衡服务器(也叫做网关服务器)**,这个服务器不处理任何的业务逻辑,而是通过负载均衡算法,将所有请求流量分配给不同的应用服务器,降低服务器的压力;负载均衡服务器就是一个ld,负责分配任务,但是不处理业务逻辑,所以对cpu资源消耗不高(注意负载均衡算法和进程调度算法不是一个东西,虽然都是分配资源,但是分配对象不同,负载均衡算法是将资源分配给不同的应用服务器,而进程调度算法是把资源分配给同一台服务器上的不同进程)

如果需要存储的数据更多呢?**引入更多的存储服务器,进行读写分离**
![[Pasted image 20250920230748.png]]

在实际的业务中,读操作的频率要远远大于写操作的频率,我们设置两个服务器,一个服务器负责写入数据.,部署在这个服务器上的数据库我们叫做**主数据库**,另一个服务器上部署的仅仅用户读数据的服务器我们叫做**从服务器**(只涉及读,不涉及更改操作),这里的关键点在于如何保证**主从数据库的一致性**

对于存储服务器的优化上述方式本质上是**开源**,我们也可以进行**节流**,比如数据库优化,sql优化,处理慢查询日志等等

**回到Redis**
为什么说Redis适合在分布式系统中应用呢?分布式系统最大的特点就是引入了多台主机,对于一些共享数据,其实是需要**跨主机通信的**,而Redis就是基于网络,可以吧自己的内存中的变量通过网络的方式传递给其他进程甚至其他主机的变量



数据库天然有个问题  响应速度慢  度硬盘这个操作太慢了
数据库冷热分离  热点数据粗出道缓存之中  新增一个缓存服务器
![[Pasted image 20250921101042.png]]


访问数据也是符合二八原则的

  20%的数据,承担着80%的访问量


Redis一般就是存储在缓存服务器之中的

先读缓存,再读数据库



缓存,数据库数据的一致性!!!    这里会存在数据同步问题  比如修改主数据库修改数据,也需要修改缓存数据库  数据的一致性是非常重要的
引入缓存,可以让数据库在同一时间内处理更多的请求,响应速度更快

引入分布式系统,不仅要处理请求量(并发量),还要能应对更大的数据量
通过负载均衡服务器来应对高并发量,但是海量数据的存储也需要**开源**,开源的方式还是引入更多的服务器资源,对于数据的存储来说,开源的方式主要有两种:
1. 分库:一个服务器存储一个数据库(database)
2. 分表:在分库的基础上,对当前数据库中数据量特别大的table进行处理,一个服务器存储一个表

主从数据库为一个单位,我们称之为**一个存储集群**
![[Pasted image 20250921101857.png]]

业务决定了技术!引入分布式系统是为了处理高并发量,高数据量的场景;但是引入分布式也就意味着复杂程度和维护成本大大升高,不能单纯为了追求技术而忽略实际的业务

**微服务架构**
> 拆分应用服务器 

所谓的微服务架构,就是将应用服务器中各个模块单独隔离出来,作为一个系统集群.如下图所示,原先的分布式系统是引入更多的应用服务器进行负载均衡调节,但是每台服务器上存储的模块/功能都是相同的(用户,商品,交易),本质上还是在一台服务器上进行数据处理的操作,这样做有一个大问题就是各个模块之间的耦合度比较高,无法定位/追责,如果用户模块修改代码导致交易模块出现问题,不容易定位问题,为了解决上述问题,可以将上述三个功能拆分出来,作为一个单独的集群

一个集群中包含应用集群,缓存,存储集群;比如抖音,有质量效能部,广告业务,直播业务等等本质上就是不同的集群
![[Pasted image 20250921103015.png]]

**优点**
1. 耦合度降低,不至于牵一发而动全身
2. 方便功能复用,比如后续引入新的功能,可以直接从对应的集群中服用已有的功能
3. 可以针对不同服务器的特点定制化设计硬件资源,比如商品集群更多的可能是查询,那就提供更大的存储集群

**缺点**
1. 性能下降:集群之间只能通过网络进行通信,网络传输的速度比磁盘传输的速度还慢;最初是直接在进程间通信的,效率很高
2. 系统复杂程度大大提升,需要更多的人力成本,比如引入更多的监控机制,配备专业的运维人员等等

# 四.基本概念
* 应用/系统:一个/一组服务器程序
* 模块(module)/组件(componet):一个系统中的具体功能
* 分布式(distributed):引入多个服务器,协同配合完成一系列工作  物理上的多个主机
* 集群(cluster):多个服务器之间,系统配合完成一系列工作     物理上/逻辑上的多个主机
* 主(master/从(slave):分布式系统中比较典型的结构,最经典的事数据库的主从;多个服务器节点,服务器节点负责修改数据.从服务器节点是**从主服务器节点同步数据**

中间件(middleware):和业务无关的服务(功能更通用的服务)

**评价指标(metric)**
可用性:系统整体可用时间 / 总的时间  最核心的地方,你的服务得能用啊
响应时长(Response TIme):性能指标,和服务器要做的业务相关
吞吐量(throughput)/并发量(concurrent):同一时刻能处理的请求数


**总结**
演进架构:
单机架构:一台服务器,包含应用服务器和存储服务器
存储服务器/应用服务器分离
负载均衡服务器:多个应用服务器组成一个集群,负载均衡服务器负责分配任务
主从分离:主节点负责修改数据,从节点负责读取数据  主从数据一致性问题~
引入缓存:将热点数据存储到缓存之中,加快数据的访问速度
分库分表:一个服务器存储一个database,甚至一个服务器存储一个table
微服务架构:从业务上进一步拆分应用服务器


# 环境搭建说明
版本:Redis 5
Linux中部署


在ubuntu中安装Redis过程

`查询Redis安装包` 
```
apt search redis
```

在下面的信息中找到Redis
![[Pasted image 20250922222053.png]]

`安装Redis` 
```
apt install redis
```

`修改Redis配置文件`
后续需要让其他主机也能访问到当前Linux服务器的Redis,需要将主机修改为Linux服务器对应的主机
```
cd /ect/redis # 进入到目录
ls # 可以看到下方有一个 redis.conf文件
vim redis.conf # 使用vim修改此文件
```

修改两个参数:
![[Pasted image 20250922222738.png]]

* bind 127.0.0.1 ::1  修改为  bind 0.0.0.0 ::1   让别的客户端也能访问到这个机器上的Redis服务器
* protected-mode yes  修改为  no  放开访问限制

`重启服务`
```
service redis-server restart
```
查看ip地址是否发生改变
![[Pasted image 20250922223058.png]]
查看服务是否启动成功
![[Pasted image 20250922223130.png]]


`使用Redis提供的自带的客户端连接Redis服务器`
```
redis-cli
```
![[Pasted image 20250922223225.png]]


